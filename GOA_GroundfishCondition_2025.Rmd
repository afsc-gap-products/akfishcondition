---
title: Gulf of Alaska Groundfish Condition
author: 
- affiliation: RACE
  description: Research Fisheries Biologist
  email: bianca.prohaska@noaa.gov
  name: Bianca Prohaska
output: word_document
fontsize: 12pt
bibliography: GOA_references.bib
csl: fish-and-fisheries.csl
addr: 
  l1: 7600 Sand Point Way NE
  l2: NMFS RACE Division, Groundfish Assessment Program
  l3: Seattle, WA 98115
---

```{r setup, include=FALSE}

library(akfishcondition)
library(knitr)
library(akgfmaps)
library(shadowtext)

region <- "GOA"

# Unzip map files
#unzip(system.file("extdata/2022_ESR.zip", package = "akfishcondition"))

#dir.create(here::here("plots", region))
map_layers <- akgfmaps::get_base_layers(select.region = "goa", set.crs = "EPSG:3338")

map_layers$survey.strata$GOA_SUBAREA <- floor((map_layers$survey.strata$STRATUM %% 100)/10)

map_layers$survey.strata <- map_layers$survey.strata |>
  dplyr::inner_join(
    data.frame(
      GOA_SUBAREA = 1:5,
      NMFS_AREA = seq(610, 650, 10)
      ),
    by = "GOA_SUBAREA"
  )

subareas <-
  map_layers$survey.strata |>
  dplyr::select(NMFS_AREA, GOA_SUBAREA) |>
  dplyr::group_by(NMFS_AREA, GOA_SUBAREA) |>
  dplyr::summarise(do_union = TRUE)

subarea_labels <- sf::st_centroid(subareas)
subarea_labels[c("X", "Y")] <- sf::st_coordinates(subarea_labels)

location_labels <-
  data.frame(
    x = c(-145, -157.5),
    y = c(57, 60),
    label = c("Gulf of Alaska", "Alaska")
  ) |>
  sf::st_as_sf(coords = c("x", "y"), crs = "WGS84") |>
  sf::st_transform(crs = "EPSG:3338")

location_labels[c("X", "Y")] <- sf::st_coordinates(location_labels)

goa_map <-
  ggplot() +
  geom_sf(data = map_layers$akland, color = "grey30", fill = "grey70", linewidth = rel(0.2)) +
  geom_sf(data = subareas,
          mapping = aes(fill = akfishcondition::set_stratum_order(NMFS_AREA, region = "GOA")),
          color = "black",
          linewidth = 0.2) +
  geom_shadowtext(data = subarea_labels,
                  mapping = aes(
                    x = X,
                    y = Y,
                    label = NMFS_AREA),
                    # color = akfishcondition::set_stratum_order(NMFS_AREA, region = "GOA")),
                  color = "black",
                  bg.color = "white") +
  geom_shadowtext(data = location_labels,
                  mapping = aes(
                    x = X,
                    y = Y,
                    label = label),
                  color = "black",
                  bg.color = "white") +
  geom_sf(data = map_layers$graticule,
          linewidth = 0.1,
          alpha = 0.3) +
  scale_fill_brewer(palette = "BrBG") +
  scale_color_brewer(palette = "BrBG") +
  scale_x_continuous(limits = map_layers$plot.boundary$x) +
  scale_y_continuous(limits = map_layers$plot.boundary$y) +
  theme_blue_strip() +
  theme(legend.position = "none",
        axis.title = element_blank())

png(here::here("plots", "GOA", "GOA_survey_area.png"), width = 169, height = 60, units = "mm", res = 300)
print(goa_map)
dev.off()

```

Contributed by Bianca Prohaska^1^ and Sean Rohan^1^

^1^ Resource Assessment and Conservation Engineering Division, Groundfish Assessment Program, Alaska Fisheries Science Center, National Marine Fisheries Service, NOAA, Seattle, WA  
**Contact**: 
**Last updated**: September 2025

**Description of Indicator**: Length-weight residuals represent how heavy a fish is per unit body length and are an indicator of somatic growth variability [@Brodeur2004]. Therefore, length-weight residuals can be considered indicators of prey availability, growth, general health, and habitat condition [@Blackwell2000; @Froese2006]. Positive length-weight residuals indicate better condition (i.e., heavier per unit length) and negative residuals indicate poorer condition (i.e., lighter per unit length) [@Froese2006]. Fish condition calculated in this way reflects realized outcomes of intrinsic and extrinsic processes that affect fish growth, which can have implications for biological productivity through direct effects on growth and indirect effects on demographic processes, such as reproduction and mortality (e.g., [@Rodgveller2019; @Barbeaux2020]).

```{r map, include = TRUE, out.width = "100%", fig.cap = "\\label{fig:figs}Figure 1. National Marine Fisheries Service (NMFS) Alaska Fisheries Science Center Resource Assessment and Conservation Engineering (AFSC/RACE) Groundfish Assessment Program (GAP) Gulf of Alaska summer bottom trawl survey area with NMFS Statistical Reporting Areas demarcated.",  echo = FALSE}
knitr::include_graphics(path = here::here("plots", "GOA", "goa_survey_area.png"))
```

The groundfish morphometric condition indicator is calculated from paired fork lengths (mm) and weights (g) of individual fishes that were collected during bottom trawl survey of the Gulf of Alaska (GOA) which were conducted by the Alaska Fisheries Science Center biennial Resource Assessment and Conservation Engineering (AFSC/RACE) - Groundfish Assessment Program’s (GAP). Fish condition analyses were applied to walleye pollock (*Gadus chalcogrammus*), Pacific cod (*Gadus macrocephalus*), arrowtooth flounder (*Atheresthes stomias*), southern rock sole (*Lepidopsetta bilineata*), northern rockfish (*Sebastes polyspinis*), Pacific ocean perch (*Sebastes alutus*), dusky rockfish (*Sebastes variabilis*), shortraker rockfish (*Sebastes borealis*), rougheye rockfish (*Sebastes aleutianus*), sharpchin rockfish (*Sebastes zacentrus*), flathead sole (*Hippoglossoides elassodon*), Dover sole (*Microstomus pacificus*), and rex sole(*Glyptocephalus zachirus*) collected in trawls with satisfactory performance at standard survey stations. Data were combined by the NMFS Statistical Reporting Areas; Shumagin (610), Chirikof (620), Kodiak (630), West Yakutat (640) and Southeast Outside (650) (Figure 1). 

To calculate indicators, length-weight relationships were estimated from linear regression models based on a log-transformation of the exponential growth relationship, _W_ = _aL_^_b_^, where _W_ is weight (g) and _L_ is fork length (mm) for all areas for the period 1990–2025. Unique unique intercepts and (*a*) and slopes (*b*) were estimated for each survey stratum, sex, and interaction between stratum and sex to account for sexual dimorphism and spatial-temporal variation in growth and bottom trawl survey sampling. Length-weight relationships for 100–250 mm fork length walleye pollock (corresponding with ages 1–2 years) were calculated separately from adult walleye pollock (> 250 mm). Residuals for individual fish were obtained by subtracting observed weights from bias-corrected weights-at-length that were estimated from regression models. Individual length-weight residuals were aggregated and averaged for each stratum, weighted based on the proportion to total biomass in each stratum from area-swept expansion of bottom-trawl survey catch per unit effort (CPUE; i.e., design-based stratum biomass estimates). Variation in fish condition was evaluated by comparing average length-weight residuals among years. To minimize the influence of unrepresentative samples on indicator calculations, combinations of species, stratum, and year with a sample size < 10 were used to fit length-weight regressions but were excluded from calculating length-weight residuals. Morphometric condition indicator time series, code for calculating the indicators, and figures showing results for individual species are available through the *akfishcondition* R package and GitHub repository (https://github.com/afsc-gap-products/akfishcondition).

**Status and Trends**: Fish condition, indicated by length-weight residuals, has varied over time for all species examined in the GOA (Figures 2 A & B). Fish condition in nine of the fourteen species investigated in 2025 was relatively similar to the values observed in 2023 (adult walleye pollock (≥250 mm), small walleye pollock (100-250 mm), Pacific cod, Pacific ocean perch, northern rockfish, dusky rockfish, arrowtooth flounder, northern rock sole, Dover sole). Condition increased in rougheye rockfish, which has been on the rise since 2021. In the remaining species, blackspotted rockfish, flathead sole, southern rock sole and rex sole, fish condition declined compared to the values observed in 2023. Shortraker rockfish and sharpchin rockfish length-weight samples were not collected in 2025, but both had shown a decline in recent years. The average fish condition of the fourteen species examined in 2025 was generally negative, with average condition for most species falling below the 1990-2025 time series mean. The exceptions were rougheye rockfish, whose mean condition was above the time series mean, and arrowtooth flounder, whose mean condition was roughly the same as the time series mean. 

```{r figure 2a grid, include = TRUE, echo = FALSE, fig.height = 14, fig.width = 12, fig.cap = "\\label{fig:figs}Figure 2A. Biomass-weighted residual body condition index across survey years (1990-2025) for sixteen Gulf of Alaska groundfish species collected on the National Marine Fisheries Service (NMFS) Alaska Fisheries Science Center Resource Assessment and Conservation Engineering (AFSC/RACE) Groundfish Assessment Program (GAP) standard summer bottom trawl survey. Filled bars denote weighted length-weight residuals, error bars denote two standard errors. Horizontal lines denote the time series mean (solid) and one (dashed) and two (dotted) standard deviations from the mean.",  message = FALSE, warning = FALSE}

group_1 <- (set_plot_order(common_name = unique(GOA_INDICATOR$FULL_REGION$common_name), region = "GOA") |> 
              factor() |>
              levels() |>
              as.character() |>
              tolower())[1:8]
group_2 <- (set_plot_order(common_name = unique(GOA_INDICATOR$FULL_REGION$common_name), region = "GOA") |> 
              factor() |>
              levels() |>
              as.character() |>
              tolower())[9:16] 

fig2a  <- plot_anomaly_timeseries(x = dplyr::filter(GOA_INDICATOR$FULL_REGION, 
                                                    tolower(common_name) %in% group_1),
                        region = "GOA", 
                        fill_color = "#0085CA", 
                        var_y_name = "mean_wt_resid", 
                        var_y_se_name = "se_wt_resid",
                        var_x_name = "year",
                        y_title = "Length-weight residual (ln(g))",
                        plot_type = "box",
                        format_for = "rmd")

fig2a_png  <- plot_anomaly_timeseries(x = dplyr::filter(GOA_INDICATOR$FULL_REGION, tolower(common_name) %in% group_1),
                        region = "GOA", 
                        fill_color = "#0085CA", 
                        var_y_name = "mean_wt_resid", 
                        var_y_se_name = "se_wt_resid",
                        var_x_name = "year",
                        y_title = "Length-weight residual (ln(g))",
                        plot_type = "box",
                        format_for = "png")

print(fig2a + theme_condition_index())
```

```{r figure 2b grid, include = TRUE, echo = FALSE, fig.height = 14, fig.width = 12, fig.cap = "\\label{fig:figs}Figure 2B. Biomass-weighted residual body condition index across survey years (1990-2025) for sixteen Gulf of Alaska groundfish species collected on the National Marine Fisheries Service (NMFS) Alaska Fisheries Science Center Resource Assessment and Conservation Engineering (AFSC/RACE) Groundfish Assessment Program (GAP) standard summer bottom trawl survey. Filled bars denote weighted length-weight residuals, error bars denote two standard errors. Horizontal lines denote the time series mean (solid) and one (dashed) and two (dotted) standard deviations from the mean.",  message = FALSE, warning = FALSE}
fig2b  <- plot_anomaly_timeseries(x = dplyr::filter(GOA_INDICATOR$FULL_REGION, tolower(common_name) %in% group_2),
                        region = "GOA", 
                        fill_color = "#0085CA", 
                        var_y_name = "mean_wt_resid", 
                        var_y_se_name = "se_wt_resid",
                        var_x_name = "year",
                        y_title = "Length-weight residual (ln(g))",
                        plot_type = "box",
                        format_for = "rmd")

fig2b_png  <- plot_anomaly_timeseries(x = dplyr::filter(GOA_INDICATOR$FULL_REGION, tolower(common_name) %in% group_2),
                        region = "GOA", 
                        fill_color = "#0085CA", 
                        var_y_name = "mean_wt_resid", 
                        var_y_se_name = "se_wt_resid",
                        var_x_name = "year",
                        y_title = "Length-weight residual (ln(g))",
                        plot_type = "box",
                        format_for = "png")

print(fig2b + theme_condition_index())
```

```{r figure 2 grid png, include=FALSE, echo=FALSE, message=FALSE, warning=FALSE}
png(here::here("plots", region, "GOAbyyear_1.png"),width=6,height=7,units="in",res=300)
print(fig2a_png + theme_blue_strip())
dev.off()

png(here::here("plots", region, "GOAbyyear_2.png"),width=6,height=7,units="in",res=300)
print(fig2b_png + theme_blue_strip())
dev.off()
```

The general patterns of above- and below-mean body condition for fish examined in the GOA in 2025 were spatially consistent across NMFS Statistical Reporting Areas (Figure 3). For all but three species in 2025, fish condition was negative across all NMFS areas. Rougheye rockfish, the only species exhibiting positive fish condition in 2025, showed positive condition in Shumagin (610) and southeast outside (650), but negative condition in Kodiak (630) and West Yakutat (640). Arrowtooth flounder had negative fish condition  in all NMFS areas observed except Chirikof (620) and Kodiak (630). Adult walleye pollock exhibited negative fish condition in all NMFS areas observed except Shumagin (610).

```{r figure 3a grid, include = TRUE, echo = FALSE, fig.height = 14, fig.width = 12, fig.cap = "\\label{fig:figs}Figure 3A. Residual body condition index for sixteen Gulf of Alaska groundfish species collected on the National Marine Fisheries Service (NMFS) Alaska Fisheries Science Center Resource Assessment and Conservation Engineering (AFSC/RACE) Groundfish Assessment Program (GAP) standard summer bottom trawl survey (1990--2025) grouped by NMFS Statistical Reporting Area.", message = FALSE, warning = FALSE}
fig3a <- plot_stratum_stacked_bar(x = dplyr::filter(GOA_INDICATOR$STRATUM, 
                                                    tolower(common_name) %in% group_1), 
                                 region = "GOA", 
                                 fill_palette = "BrBG",
                                 var_y_name = "stratum_resid_mean", 
                                 var_x_name = "year",
                                 var_group_name = "area_id",
                                 fill_title = "Stratum",
                                 y_title = "Length-weight residual (ln(g))")

fig3b <- plot_stratum_stacked_bar(x = dplyr::filter(GOA_INDICATOR$STRATUM, 
                                                    tolower(common_name) %in% group_2), 
                                 region = "GOA", 
                                 fill_palette = "BrBG",
                                 var_y_name = "stratum_resid_mean", 
                                 var_x_name = "year",
                                 var_group_name = "area_id",
                                 fill_title = "Stratum",
                                 y_title = "Length-weight residual (ln(g))")

print(fig3a + theme_condition_index() + 
        theme_condition_index() + 
        theme(legend.position = "bottom", 
              legend.title = element_blank()))

```

```{r figure 3b grid, include = TRUE, echo = FALSE, fig.height = 14, fig.width = 12, fig.cap = "\\label{fig:figs}Figure 3B. Residual body condition index for sixteen Gulf of Alaska groundfish species collected on the National Marine Fisheries Service (NMFS) Alaska Fisheries Science Center Resource Assessment and Conservation Engineering (AFSC/RACE) Groundfish Assessment Program (GAP) standard summer bottom trawl survey (1990--2025) grouped by NMFS Statistical Reporting Area.", message = FALSE, warning = FALSE}
print(fig3b + theme_condition_index() + 
        theme_condition_index() + 
        theme(legend.position = "bottom", 
              legend.title = element_blank()))
```

```{r figure 3 grid png, include=FALSE, echo=FALSE, message=FALSE, warning=FALSE}
png(here::here("plots", region, "GOA_condition_by_stratum_1.png") ,width=6,height=7,units="in",res=300)
print(fig3a + theme_blue_strip())
dev.off()

png(here::here("plots", region, "GOA_condition_by_stratum_2.png") ,width=6,height=7,units="in",res=300)
print(fig3b + theme_blue_strip())
dev.off()

plot_species_stratum_bar(
  x = GOA_INDICATOR$STRATUM,
  region = "GOA",
  var_x_name = "year",
  var_y_name = "stratum_resid_mean",
  var_y_se_name = "stratum_resid_se",
  y_title = "Length-weight residual (ln(g))",
  var_group_name = "area_id",
  fill_title = "Stratum",
  fill_palette = "BrBG",
  write_plot = TRUE)
```

**Factors causing observed trends**: Factors that could affect residual fish body condition include temperature, trawl survey timing, stomach fullness, movement in or out of the survey area, and variable somatic growth. Following an unprecedented marine heatwave from 2014–2016 [@Bond2015; @Stabeno2019; @Barbeaux2020], there has been a general trend of warming ocean temperatures in the survey area. Bottom temperature anomalies show temperatures above historical averages across the western and central GOA in 2025 (Rohan, this year’s ESR); these warmer temperatures could be affecting fish growth conditions in this region. Changing ocean conditions, along with normal patterns of movement, can cause the proportion of the population resident in the sampling area during the annual bottom trawl survey to vary. Recorded changes attributed to the marine heatwave included species abundances, sizes, growth rates, weight/body condition, reproductive success, and species composition [@Suryan2021]. Warmer ocean temperatures can lead to lower energy (leaner) prey, increased metabolic needs of younger fish, and therefore slower growth for juveniles, as observed in Pacific cod [@Barbeaux2020] and early life history stages of walleye pollock [@Rogers2021].   Spatial variability in residual condition may also reflect local environmental variation that influences growth and prey availability. 

**Implications**: Variations in body condition likely have implications for fish survival. The condition of GOA groundfish may contribute to variation in  mortality. As additional years are added to the time series, the relationship between length-weight residuals and subsequent survival will be examined further. It is important that residual body condition for most species in these analyses was computed for all sizes and sexes combined. Prey consumption and habitat use patterns often differ among life stages which can cause different responses to temperature variation among sizes/ages of a single species (e.g., [@Oke2022]). Future analyses may benefit from examining life-stages (e.g., early juvenile, subadult, and adult phases) as well as potential effects of density-dependent growth.  

The continuing pattern of below average body condition for many GOA species over the last decade is a potential cause for concern. It could reflect the influence of locally changing environmental conditions that are inhibiting growth, local production, or survivorship. Indications are that the Warm Blob [@Bond2015; @Stabeno2019] has been followed by subsequent years with elevated water temperatures (Oceanographic Synthesis, this year’s ESR) which may be related to changes in fish condition. As more years of fish condition data are added to the record, and as our understanding of the relationships between condition, growth, production and survival expands, we hope to gain deeper insights into the overall health of fish populations in the GOA. 


## References